import * as wordCountUtil from "./wordCountUtil";

const cc13Post = `[QUOTE=Lil'twick;864785][color=indianred][b]ChrisClark13[/b]-

Frustrations running high with your new body, you decide to use your other self to bark orders. You know how to do this, but your instincts are leading you astray. You can do this, but are too frustrated to think properly. Why did that idiot have to get himself killed? No matter, your friends were still with you.

Finnegan managed to easily drag the backpack out from your old trainer's body and placed it at your feet, before going to further look around the room. The Thievul carefully tiptoed around the corpses while doing this, more or less just focusing on what could prove useful to you.

Toby, however, was carefully using his Foresight to look for the key. He spots a few things of value and tells Finnegan to grab them while doing so. The Pokemon then manages to spot the key and rushes in to obtain it himself. It was slightly sticking out from beneath a book, which seems to be eldritch nonsense. The Delcatty then hands you the key, and you make quick use in unlocking the cage.

The Minior then runs into your arms and refuses to leave, scared of what might happen if it stays in this place. Toby mewls, and Finnegan yips. Seems both of them have finished here, and have a little bundle of items for all of you to look at. You then hear the door shake massively, almost as if it was about to be burst down.

Feeling a surge of power, your body starts to move on its own as you and your team run through the Garchomp's hole. As you run through, you see the self-same Pokemon pop up behind you as use a [b]Rock Slide[/b] to close the hole off before burrowing beneath the earth once more. You owed that Pokemon, that was for sure, but that was something that could be dealt with later.

Your feet continue to run, alongside your Pokemon, through the tunnel. It feels like an hour before you see light, and find yourself emerging onto the Ashen Coast. The sun hung high, and the ocean waves were a relief to see.  You could see a boat starting to come on the horizon. Ah, freedom. Soon. Yet, for now, there was one last thing to do.

The Minior floats out of your arms, and looks at you. Perhaps it would be best to take it along with you, as your first official Pokemon.  Better than what the alternative could be if the poor thing was already captured once. The choice was yours, of course.

What do you do?[/color][/QUOTE]
[color=indianred]Annahime lets herself finally breathe a sigh of relief as she makes it out of the tunnel. Upon loosening her grip on the Minior, it floats up and seems to consider her with it's strange eyes.

Neither now seems to know what to do with the other, but one- maybe two things were sure. First was that there was no way she was leaving this Pokemon on this island. The evil humans would certainly take their cruel revenge on upon it and... well, if it had been marked in any way by the dark magics that went on in there... no doubt it would be valuable to them- something she needed to deny them, if only out of spite.

The second thing was well, they had both been in there- both survived... [b]that[/b] together. They were now bonded- in a way. Something inside of her told her that it was best not to ignore a bond such as that.

Slowly, Annahime reached into her... human's... Curtis's bag and rifled through for a suitable Pokeball for the living meteor. An ordinary one wouldn't do to deepen a bond such as theirs... Hm, the only one suitable was another of the once she was in- a ball providing comfort and [b]luxury[/b]. Suitable for a creature in need of comfort she supposed.

Pulling out the black-and-gold ball she pressed the button to expand it and offered it in an outstretched hand. Slowly, and after a few tries, she managed to make the right words come out of her human-self's mouth in a low and serious tone, "Come, let me take you away from this place."

- - - - -

After that, Annahime made her way down to the boat as fast as her unfamiliar, gangly human legs could manage, more than once having her Ninetales-self use Psychic to steady her footing.

Once near to the boat, she simply waved to it and held the return ticket high in the air. Surely, they would not ignore a maiden and a handful of Pokemon in need? Though once aboard, she would not much be one for conversation, instead sequestering herself within what private space she could find.

Occasional sounds of sobs and cries, both human and animal, would be heard on the way back coming from that space.[/color]`;

const cc13PostNoQuote = `[color=indianred]Annahime lets herself finally breathe a sigh of relief as she makes it out of the tunnel. Upon loosening her grip on the Minior, it floats up and seems to consider her with it's strange eyes.

Neither now seems to know what to do with the other, but one- maybe two things were sure. First was that there was no way she was leaving this Pokemon on this island. The evil humans would certainly take their cruel revenge on upon it and... well, if it had been marked in any way by the dark magics that went on in there... no doubt it would be valuable to them- something she needed to deny them, if only out of spite.

The second thing was well, they had both been in there- both survived... [b]that[/b] together. They were now bonded- in a way. Something inside of her told her that it was best not to ignore a bond such as that.

Slowly, Annahime reached into her... human's... Curtis's bag and rifled through for a suitable Pokeball for the living meteor. An ordinary one wouldn't do to deepen a bond such as theirs... Hm, the only one suitable was another of the once she was in- a ball providing comfort and [b]luxury[/b]. Suitable for a creature in need of comfort she supposed.

Pulling out the black-and-gold ball she pressed the button to expand it and offered it in an outstretched hand. Slowly, and after a few tries, she managed to make the right words come out of her human-self's mouth in a low and serious tone, "Come, let me take you away from this place."

- - - - -

After that, Annahime made her way down to the boat as fast as her unfamiliar, gangly human legs could manage, more than once having her Ninetales-self use Psychic to steady her footing.

Once near to the boat, she simply waved to it and held the return ticket high in the air. Surely, they would not ignore a maiden and a handful of Pokemon in need? Though once aboard, she would not much be one for conversation, instead sequestering herself within what private space she could find.

Occasional sounds of sobs and cries, both human and animal, would be heard on the way back coming from that space.[/color]`;

const cc13PostNoBBCode = `Annahime lets herself finally breathe a sigh of relief as she makes it out of the tunnel. Upon loosening her grip on the Minior, it floats up and seems to consider her with it's strange eyes.

Neither now seems to know what to do with the other, but one- maybe two things were sure. First was that there was no way she was leaving this Pokemon on this island. The evil humans would certainly take their cruel revenge on upon it and... well, if it had been marked in any way by the dark magics that went on in there... no doubt it would be valuable to them- something she needed to deny them, if only out of spite.

The second thing was well, they had both been in there- both survived... that together. They were now bonded- in a way. Something inside of her told her that it was best not to ignore a bond such as that.

Slowly, Annahime reached into her... human's... Curtis's bag and rifled through for a suitable Pokeball for the living meteor. An ordinary one wouldn't do to deepen a bond such as theirs... Hm, the only one suitable was another of the once she was in- a ball providing comfort and luxury. Suitable for a creature in need of comfort she supposed.

Pulling out the black-and-gold ball she pressed the button to expand it and offered it in an outstretched hand. Slowly, and after a few tries, she managed to make the right words come out of her human-self's mouth in a low and serious tone, "Come, let me take you away from this place."

- - - - -

After that, Annahime made her way down to the boat as fast as her unfamiliar, gangly human legs could manage, more than once having her Ninetales-self use Psychic to steady her footing.

Once near to the boat, she simply waved to it and held the return ticket high in the air. Surely, they would not ignore a maiden and a handful of Pokemon in need? Though once aboard, she would not much be one for conversation, instead sequestering herself within what private space she could find.

Occasional sounds of sobs and cries, both human and animal, would be heard on the way back coming from that space.`;

const mmPost = `The battle was nearing its climax, but Ekans getting put to sleep made the guards complacent. Not for a second did they consider the notion that Maribel might have a way to wake Ekans up, and yet, she certainly did. The Blue Flute's melody was played not a moment too soon, with Ekans awakening before Mr. Mime could beset it with a Nightmare. This left Mr. Mime open to attack, and Ekans was glad to oblige, pelting the Psychic/Fairy-type with a powerful Stone Edge that knocked it clean out.

Koffing and Machoke, meanwhile, were staring each other down from either side of the Fire Spin, but it was that move's effect on the latter that spurred her into action. She attempted to break free of the Fire Spin through sheer brute force, but not only did this not work, she was wide open for Koffing's Smog attack. As Maribel had predicted, the combination of Smog and fire had an explosive effect. Maribel was pleased with herself, but didn't let her guard down- you just don't do that when you can't see what became of your opponent. Indeed, this was proven a prudent course of action as Machoke, covered in soot, sprang forth from the cloud of smoke, slamming Koffing with a Mega Punch... which turned out to be just what she was after. Koffing held on just barely- you could count the remaining hit points on one hand. But it was enough- she fought back with a souped-up Revenge, and this was the final blow that took Machoke down.

Maribel smiled as the battle conclude, the background music going into a victorious flourish, the gathered crowd applauding, the guards flabbergasted at having lost like this. Still, after withdrawing their fallen Pokémon, they approached Maribel and bowed to her, respectful in their defeat. Maribel bowed back- she, too, was raised to be respectful. "Thank you for a wonderful battle," she said to the guards as she accepted the small satchel from the guards. Before she could look into it, though, she threw her arms around the pair of panting Poison-types. "Ekans, Koffing, you two were amazing!" she beamed.

"Ekanssss," Ekans hissed happily.

"Koff, Koffing!" Koffing chimed in.

The tired intonations in their happy responses were not lost on Maribel, who reached into her bag, producing several restorative fruits. "Here you go, you two," she said, offering four Gold Berries to the pair- two for each. "Eat up. You've more than earned 'em." And indeed, if the pair were inclined to argue for whatever reason, they really didn't have a leg to stand on. Literally, even. Each of them ate two of the four Gold Berries to replenish their stamina, while Maribel examined her own rewards. ₽200, a pair of Guard Specs., TMs for Mega Punch and Dream Eater... A hefty chunk of prizes, especially considering the comparatively minimal satchel containing them, but Maribel didn't see that as weird- wasn't so different from your standard Trainer-grade bags and backpacks.

Once everything had been squared away, or eaten as the case may be, Maribel and her Poison-types looked onward to the freshly-opened path to the throne room. The young Trainer's eyes lingered on the scorched carpet, though- she did feel a tinge of regret for having damaged it, though she couldn't see a way to fix it now. Besides, naught but a couple of nobles actually seemed to mind the mess any. In any case, the way forward was clear, and so they proceeded onward, towards the throne room, now that the way to it was no longer blocked off to them.`;

it("should remove content in quote tags", () => {
  expect(wordCountUtil.removeQuoteBlocks(cc13Post)).toEqual(cc13PostNoQuote);
});

it("should preserve bbcode inside noparse tags", () => {
  const text =
    "[noparse][b][i]keep[/i][/b][/noparse][s][b]delete[/b][/s][noparse][u][b]keep[/b][/u][/noparse]";
  const result = "[b][i]keep[/i][/b]delete[u][b]keep[/b][/u]";

  expect(wordCountUtil.removeBBCode(text)).toEqual(result);
});

it("should remove content in quote tags and remove bbcode", () => {
  console.log(wordCountUtil.removeBBCode(cc13Post));
  expect(wordCountUtil.removeBBCode(cc13Post)).toEqual(cc13PostNoBBCode);
});

it("should count 599 words is Missingno. Master's plain text post", () => {
  expect(wordCountUtil.writtenKittenWordCount(mmPost)).toEqual(599);
});

it("should count 384 words in ChrisClark13's bbcode post", () => {
  expect(wordCountUtil.countWordsInBBCode(cc13Post)).toEqual(384);
});
